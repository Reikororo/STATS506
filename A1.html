<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STATS506A1 Leshan Song</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="A1_files/libs/clipboard/clipboard.min.js"></script>
<script src="A1_files/libs/quarto-html/quarto.js"></script>
<script src="A1_files/libs/quarto-html/popper.min.js"></script>
<script src="A1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="A1_files/libs/quarto-html/anchor.min.js"></script>
<link href="A1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="A1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="A1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="A1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="A1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">STATS506A1 Leshan Song</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Import the data into a data.frame in R </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'/Users/songleshan/Desktop/stats506/wine/wine.data'</span>, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Use the information in the “wine.names” file to give appropriate column names.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">'Class'</span>,<span class="st">'Alcohol'</span>,<span class="st">'Malic acid'</span>,<span class="st">'Ash'</span>,<span class="st">'Alcalinity of ash'</span>,<span class="st">'Magnesium'</span>,<span class="st">'Total phenols'</span>,<span class="st">'Flavanoids'</span>,<span class="st">'Nonflavanoid phenols'</span>,<span class="st">'Proanthocyanins'</span>,<span class="st">'Color intensity'</span>,<span class="st">'Hue'</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">'OD280/OD315 of diluted wines'</span>,<span class="st">'Proline'</span>)          </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>Class)<span class="co">#the number of wines within each class is correct as reported in “wine.names”.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3 
59 71 48 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Class[<span class="fu">which.max</span>(df<span class="sc">$</span>Alcohol)]<span class="co">#The wine with the highest alcohol content belongs to 1st class</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Class[<span class="fu">which.min</span>(df<span class="sc">$</span>Alcohol)]<span class="co">#The wine with the lowest alcohol content belongs to 2nd class</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(df<span class="sc">$</span>Magnesium <span class="sc">&gt;</span> <span class="dv">114</span>)<span class="co">#26 of these wines have higher levels of magnesium than that.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((df<span class="sc">$</span>Magnesium <span class="sc">&gt;</span> <span class="dv">114</span>) <span class="sc">&amp;</span> (df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">1</span>))<span class="co">#15 of class1 wines have higher levels of magnesium than that.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((df<span class="sc">$</span>Magnesium <span class="sc">&gt;</span> <span class="dv">114</span>)<span class="sc">&amp;</span>(df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">2</span>))<span class="co">#6 of class2 wines have higher levels of magnesium than that.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((df<span class="sc">$</span>Magnesium <span class="sc">&gt;</span> <span class="dv">114</span>)<span class="sc">&amp;</span>(df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">3</span>))<span class="co">#5 of class3 wines have higher levels of magnesium than that.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a table identifying the average value of each variable, providing one row for the overall average, and one row per class with class averages. </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>meanall <span class="ot">&lt;-</span> <span class="fu">sapply</span>(df, mean)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>meanclass1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">1</span>,], mean)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>meanclass2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">2</span>,], mean)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>meanclass3 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">3</span>,], mean)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(meanall, meanclass1, meanclass2, meanclass3)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mat[, (<span class="sc">-</span><span class="dv">1</span>)])</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Alcohol Malic.acid      Ash Alcalinity.of.ash Magnesium
meanall    13.00062   2.336348 2.366517          19.49494  99.74157
meanclass1 13.74475   2.010678 2.455593          17.03729 106.33898
meanclass2 12.27873   1.932676 2.244789          20.23803  94.54930
meanclass3 13.15375   3.333750 2.437083          21.41667  99.31250
           Total.phenols Flavanoids Nonflavanoid.phenols Proanthocyanins
meanall         2.295112  2.0292697            0.3618539        1.590899
meanclass1      2.840169  2.9823729            0.2900000        1.899322
meanclass2      2.258873  2.0808451            0.3636620        1.630282
meanclass3      1.678750  0.7814583            0.4475000        1.153542
           Color.intensity       Hue OD280.OD315.of.diluted.wines   Proline
meanall           5.058090 0.9574494                     2.611685  746.8933
meanclass1        5.528305 1.0620339                     3.157797 1115.7119
meanclass2        3.086620 1.0562817                     2.785352  519.5070
meanclass3        7.396250 0.6827083                     1.683542  629.8958</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#welch t-tests for class1 and class2</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">4</span>], df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  df[df$Class == 1, 4] and df[df$Class == 2, 4]
t = 4.4184, df = 125.59, p-value = 2.124e-05
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.116383 0.305226
sample estimates:
mean of x mean of y 
 2.455593  2.244789 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">mean</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">4</span>]) <span class="sc">-</span> <span class="fu">mean</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">4</span>])</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">1</span>,<span class="dv">4</span>])<span class="sc">/</span><span class="dv">59</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">2</span>,<span class="dv">4</span>])<span class="sc">/</span><span class="dv">71</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(s1<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>s2<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>dof <span class="ot">&lt;-</span> (s1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">59</span><span class="sc">+</span>s2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">71</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(s1<span class="sc">^</span><span class="dv">4</span><span class="sc">/</span>(<span class="dv">59</span><span class="sc">*</span><span class="dv">59</span><span class="sc">*</span><span class="dv">58</span>)<span class="sc">+</span>s2<span class="sc">^</span><span class="dv">4</span><span class="sc">/</span>(<span class="dv">71</span><span class="sc">*</span><span class="dv">71</span><span class="sc">*</span><span class="dv">70</span>))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> d<span class="sc">/</span><span class="fu">sqrt</span>(s1<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>s2<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>dof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 127.6968</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.418367</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(t, dof))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.100286e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#p-value&lt;0.05 We have sufficient evidence to conclude that the level of Ash differs across class1 and class2.</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#welch t-tests for class1 and class3</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">4</span>], df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">3</span>, <span class="dv">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  df[df$Class == 1, 4] and df[df$Class == 3, 4]
t = 0.46489, df = 105, p-value = 0.643
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.06043717  0.09745695
sample estimates:
mean of x mean of y 
 2.455593  2.437083 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">mean</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">4</span>])<span class="sc">-</span><span class="fu">mean</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">1</span>,<span class="dv">4</span>])<span class="sc">/</span><span class="dv">59</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">3</span>,<span class="dv">4</span>])<span class="sc">/</span><span class="dv">48</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(s1<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>s2<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>dof <span class="ot">&lt;-</span> (s1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">59</span><span class="sc">+</span>s2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">48</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(s1<span class="sc">^</span><span class="dv">4</span><span class="sc">/</span>(<span class="dv">59</span><span class="sc">*</span><span class="dv">59</span><span class="sc">*</span><span class="dv">58</span>)<span class="sc">+</span>s2<span class="sc">^</span><span class="dv">4</span><span class="sc">/</span>(<span class="dv">48</span><span class="sc">*</span><span class="dv">48</span><span class="sc">*</span><span class="dv">47</span>))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> d<span class="sc">/</span><span class="fu">sqrt</span>(s1<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>s2<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>dof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 103.862</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4648899</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(t, dof))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6429835</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#p-value&gt;0.05 We don't have sufficient evidence to conclude that the level of Ash differs across class1 and class3.</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">4</span>],df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">3</span>, <span class="dv">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  df[df$Class == 2, 4] and df[df$Class == 3, 4]
t = -4.184, df = 114.96, p-value = 5.627e-05
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.2833328 -0.1012564
sample estimates:
mean of x mean of y 
 2.244789  2.437083 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">mean</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">2</span>,<span class="dv">4</span>])<span class="sc">-</span><span class="fu">mean</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">2</span>,<span class="dv">4</span>])<span class="sc">/</span><span class="dv">71</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(df[df<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">3</span>,<span class="dv">4</span>])<span class="sc">/</span><span class="dv">48</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(s1<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>s2<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>dof <span class="ot">&lt;-</span> (s1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">71</span><span class="sc">+</span>s2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">48</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(s1<span class="sc">^</span><span class="dv">4</span><span class="sc">/</span>(<span class="dv">71</span><span class="sc">*</span><span class="dv">71</span><span class="sc">*</span><span class="dv">70</span>)<span class="sc">+</span>s2<span class="sc">^</span><span class="dv">4</span><span class="sc">/</span>(<span class="dv">48</span><span class="sc">*</span><span class="dv">48</span><span class="sc">*</span><span class="dv">47</span>))</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> d<span class="sc">/</span><span class="fu">sqrt</span>(s1<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>s2<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>dof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 116.6505</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -4.183958</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(t), dof))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.576653e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#p-value&lt;0.05 We have sufficient evidence to conclude that the level of Ash differs across class3 and class2.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>isPerfectPower <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p) {</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> n<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>p)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">all.equal</span>(<span class="fu">round</span>(r), r) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    l <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">'isPerfectPower'</span> <span class="ot">=</span> <span class="cn">TRUE</span>, <span class="st">'root'</span> <span class="ot">=</span> r)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span> (l)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> {</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    l <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">'isPerfectPower'</span> <span class="ot">=</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span> (l)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="fu">isPerfectPower</span>(<span class="dv">8000</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$isPerfectPower
[1] TRUE

$root
[1] 20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">isPerfectPower</span>(<span class="dv">200</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$isPerfectPower
[1] FALSE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>findRootPower <span class="ot">&lt;-</span> <span class="cf">function</span>(int) {</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (i <span class="sc">&lt;=</span> <span class="dv">1001</span>) {</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">isPerfectPower</span>(int, i)[[<span class="dv">1</span>]] <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>      i <span class="ot">&lt;-</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>      r <span class="ot">&lt;-</span> int<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>i)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">break</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">1001</span>) {</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span> (<span class="st">'this int is not the perfect power for power&lt;=1000'</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="fu">return</span> (<span class="fu">paste0</span>(int,<span class="st">'='</span>,r,<span class="st">'^'</span>,i))</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="fu">findRootPower</span>(<span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1000=10^3"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">findRootPower</span>(<span class="dv">13060694016</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "13060694016=6^13"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">findRootPower</span>(<span class="dv">7776</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "7776=6^5"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">findRootPower</span>(<span class="dv">170859375</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "170859375=15^7"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">findRootPower</span>(<span class="dv">58247422</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "this int is not the perfect power for power&lt;=1000"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">findRootPower</span>(<span class="dv">94143178827</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "94143178827=3^23"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">findRootPower</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "this int is not the perfect power for power&lt;=1000"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">findRootPower</span>(<span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "this int is not the perfect power for power&lt;=1000"</code></pre>
</div>
</div>
<p><strong><em>code below is generated by ChatGPT except for a minor modification and some comments</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to determine the name of a poker hand</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>getHandName <span class="ot">&lt;-</span> <span class="cf">function</span>(suits, ranks) {</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count the occurrences of each rank</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  rankCounts <span class="ot">&lt;-</span> <span class="fu">table</span>(ranks)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for a flush</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  isFlush <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(suits)) <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for a straight</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  isStraight <span class="ot">&lt;-</span> <span class="fu">all</span>(<span class="fu">diff</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(ranks))) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#original version by ChatGPT:isStraight &lt;- diff(sort(unique(ranks))) == 1</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for a straight flush</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  isStraightFlush <span class="ot">&lt;-</span> isFlush <span class="sc">&amp;&amp;</span> isStraight</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for four of a kind</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  isFourOfAKind <span class="ot">&lt;-</span> <span class="fu">any</span>(rankCounts <span class="sc">==</span> <span class="dv">4</span>)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for a full house</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  isFullHouse <span class="ot">&lt;-</span> <span class="fu">any</span>(rankCounts <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">&amp;&amp;</span> <span class="fu">any</span>(rankCounts <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for a three of a kind</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  isThreeOfAKind <span class="ot">&lt;-</span> <span class="fu">any</span>(rankCounts <span class="sc">==</span> <span class="dv">3</span>)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for two pairs</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>  isTwoPair <span class="ot">&lt;-</span> <span class="fu">sum</span>(rankCounts <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">&gt;=</span> <span class="dv">2</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for a pair</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  isPair <span class="ot">&lt;-</span> <span class="fu">any</span>(rankCounts <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine the hand name based on the above checks</span></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (isStraightFlush) {</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Straight Flush"</span>)</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (isFourOfAKind) {</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Four of a Kind"</span>)</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (isFullHouse) {</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Full House"</span>)</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (isFlush) {</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Flush"</span>)</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (isStraight) {</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Straight"</span>)</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (isThreeOfAKind) {</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Three of a Kind"</span>)</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (isTwoPair) {</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Two Pair"</span>)</span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (isPair) {</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Pair"</span>)</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">#doesn't belong to any hand name above</span></span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"High Card"</span>)</span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to simulate dealing a round of cards in poker</span></span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>dealPokerRound <span class="ot">&lt;-</span> <span class="cf">function</span>(numPlayers) {</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a deck of cards</span></span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>  <span class="co">#4 different suits, each appears for 13 times</span></span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>  suits <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Spades"</span>, <span class="st">"Hearts"</span>, <span class="st">"Diamonds"</span>, <span class="st">"Clubs"</span>), <span class="at">times =</span> <span class="dv">13</span>)</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>  <span class="co">#13 different suits, each appears for 4 times</span></span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>  ranks <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>, <span class="at">times =</span> <span class="dv">4</span>)</span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Shuffle the deck by sampling index 1 to 52 without replacement</span></span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>  deck <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>)</span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Deal cards to each player</span></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>  hands <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, numPlayers)</span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>numPlayers) {</span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>    <span class="co">#e.g the resampled deck is (51,4,2,7,8,21,33,20,25,1.......)</span></span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>    <span class="co">#player 1 gets the first five index(51,4,2,7,8),</span></span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>    <span class="co">#player 2 gets the second five index(21,33,20,25,1), etc</span></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>    start <span class="ot">&lt;-</span> (i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a>    end <span class="ot">&lt;-</span> start <span class="sc">+</span> <span class="dv">4</span></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>    hand <span class="ot">&lt;-</span> deck[start<span class="sc">:</span>end]</span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>    <span class="co">#then the players get the suits and ranks from the vectors of ranks and suits </span></span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>    <span class="co">#subset by the indexes</span></span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>    <span class="co">#e.g the vector of ranks is (1,1,1,1,2,2,2,2,3,3,3,3,....)</span></span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>    <span class="co">#the player with the hand of index(1,3,4,5,10) gets the ranks of(1,1,1,2,3)</span></span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a>    suitsHand <span class="ot">&lt;-</span> suits[hand]</span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>    ranksHand <span class="ot">&lt;-</span> ranks[hand]</span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a>    <span class="co">#get the handname of this combination of suits and ranks</span></span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a>    handName <span class="ot">&lt;-</span> <span class="fu">getHandName</span>(suitsHand, ranksHand)</span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a>    <span class="co">#create the result dataframe</span></span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a>    hands[[i]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Suit =</span> suitsHand, <span class="at">Rank =</span> ranksHand, <span class="at">HandName =</span> handName)</span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the hands</span></span>
<span id="cb63-86"><a href="#cb63-86" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>numPlayers) {</span>
<span id="cb63-87"><a href="#cb63-87" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print ith Player player's hand of card</span></span>
<span id="cb63-88"><a href="#cb63-88" aria-hidden="true" tabindex="-1"></a>    <span class="co">#e.g Player 1 Hand:</span></span>
<span id="cb63-89"><a href="#cb63-89" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Straight</span></span>
<span id="cb63-90"><a href="#cb63-90" aria-hidden="true" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb63-91"><a href="#cb63-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Player"</span>, i, <span class="st">"Hand:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-92"><a href="#cb63-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(hands[[i]])</span>
<span id="cb63-93"><a href="#cb63-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-94"><a href="#cb63-94" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-95"><a href="#cb63-95" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of getHandName</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>suits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Spades"</span>, <span class="st">"Hearts"</span>, <span class="st">"Diamonds"</span>, <span class="st">"Clubs"</span>, <span class="st">"Spades"</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>ranks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">#should be Straight</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>handName <span class="ot">&lt;-</span> <span class="fu">getHandName</span>(suits, ranks)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(handName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Straight"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>suits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Spades"</span>, <span class="st">"Spades"</span>, <span class="st">"Spades"</span>, <span class="st">"Spades"</span>, <span class="st">"Spades"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>ranks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#should be Straight Flush</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>handName <span class="ot">&lt;-</span> <span class="fu">getHandName</span>(suits, ranks)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(handName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Straight Flush"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>suits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Spades"</span>, <span class="st">"Hearts"</span>, <span class="st">"Diamonds"</span>, <span class="st">"Clubs"</span>, <span class="st">"Spades"</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>ranks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co">#should be Three of A kind</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>handName <span class="ot">&lt;-</span> <span class="fu">getHandName</span>(suits, ranks)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(handName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Three of a Kind"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>suits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Spades"</span>, <span class="st">"Hearts"</span>, <span class="st">"Diamonds"</span>, <span class="st">"Clubs"</span>, <span class="st">"Spades"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>ranks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co">#should be full house</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>handName <span class="ot">&lt;-</span> <span class="fu">getHandName</span>(suits, ranks)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(handName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Full House"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>suits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Spades"</span>, <span class="st">"Hearts"</span>, <span class="st">"Diamonds"</span>, <span class="st">"Clubs"</span>, <span class="st">"Spades"</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>ranks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">11</span>, <span class="dv">12</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co">#should be High Card</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>handName <span class="ot">&lt;-</span> <span class="fu">getHandName</span>(suits, ranks)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(handName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "High Card"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>suits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Spades"</span>, <span class="st">"Hearts"</span>, <span class="st">"Diamonds"</span>, <span class="st">"Clubs"</span>, <span class="st">"Spades"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>ranks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">6</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co">#should be Four of A kind</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>handName <span class="ot">&lt;-</span> <span class="fu">getHandName</span>(suits, ranks)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(handName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Four of a Kind"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>suits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Spades"</span>, <span class="st">"Hearts"</span>, <span class="st">"Diamonds"</span>, <span class="st">"Clubs"</span>, <span class="st">"Spades"</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>ranks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">8</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co">#should be Two pair</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>handName <span class="ot">&lt;-</span> <span class="fu">getHandName</span>(suits, ranks)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(handName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Two Pair"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>suits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Spades"</span>, <span class="st">"Hearts"</span>, <span class="st">"Diamonds"</span>, <span class="st">"Clubs"</span>, <span class="st">"Spades"</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>ranks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">8</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co">#should be Two pair</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>handName <span class="ot">&lt;-</span> <span class="fu">getHandName</span>(suits, ranks)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(handName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pair"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Examples of dealPokerRound</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>t1<span class="ot">&lt;-</span><span class="fu">dealPokerRound</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Player 1 Hand:
      Suit Rank  HandName
1    Clubs    4 High Card
2 Diamonds   13 High Card
3   Spades    1 High Card
4   Hearts    8 High Card
5 Diamonds   10 High Card

Player 2 Hand:
      Suit Rank  HandName
1 Diamonds    4 High Card
2   Hearts    1 High Card
3   Hearts    5 High Card
4   Spades    7 High Card
5   Spades    8 High Card

Player 3 Hand:
      Suit Rank  HandName
1 Diamonds    8 High Card
2   Hearts   10 High Card
3 Diamonds    7 High Card
4   Spades    9 High Card
5 Diamonds    2 High Card

Player 4 Hand:
    Suit Rank HandName
1 Hearts    3 Two Pair
2 Spades   12 Two Pair
3 Spades   10 Two Pair
4  Clubs   10 Two Pair
5 Hearts   12 Two Pair</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>t2<span class="ot">&lt;-</span><span class="fu">dealPokerRound</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Player 1 Hand:
      Suit Rank HandName
1   Spades    8     Pair
2 Diamonds    2     Pair
3   Hearts    6     Pair
4   Hearts   11     Pair
5    Clubs    6     Pair

Player 2 Hand:
    Suit Rank  HandName
1  Clubs    8 High Card
2 Spades    4 High Card
3 Spades    3 High Card
4 Hearts    7 High Card
5  Clubs   12 High Card

Player 3 Hand:
      Suit Rank HandName
1   Spades    2     Pair
2 Diamonds   11     Pair
3   Spades    1     Pair
4 Diamonds    3     Pair
5    Clubs    3     Pair

Player 4 Hand:
      Suit Rank HandName
1    Clubs    9     Pair
2 Diamonds    8     Pair
3   Spades    7     Pair
4   Hearts   12     Pair
5   Hearts    8     Pair</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>t3<span class="ot">&lt;-</span><span class="fu">dealPokerRound</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Player 1 Hand:
      Suit Rank  HandName
1   Spades    5 High Card
2    Clubs   12 High Card
3 Diamonds   13 High Card
4    Clubs   10 High Card
5    Clubs    1 High Card

Player 2 Hand:
      Suit Rank  HandName
1 Diamonds    4 High Card
2 Diamonds    5 High Card
3    Clubs    8 High Card
4    Clubs    7 High Card
5   Hearts   10 High Card

Player 3 Hand:
    Suit Rank  HandName
1  Clubs    9 High Card
2 Hearts    3 High Card
3 Spades    6 High Card
4 Spades   11 High Card
5 Hearts    2 High Card

Player 4 Hand:
      Suit Rank HandName
1   Spades    3     Pair
2    Clubs   13     Pair
3   Spades    9     Pair
4 Diamonds    9     Pair
5   Hearts    5     Pair</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>t4<span class="ot">&lt;-</span><span class="fu">dealPokerRound</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Player 1 Hand:
      Suit Rank  HandName
1 Diamonds   11 High Card
2 Diamonds   12 High Card
3 Diamonds    3 High Card
4 Diamonds    7 High Card
5    Clubs    5 High Card

Player 2 Hand:
    Suit Rank  HandName
1 Hearts    4 High Card
2 Hearts   12 High Card
3 Hearts    2 High Card
4  Clubs   11 High Card
5 Spades    1 High Card

Player 3 Hand:
      Suit Rank  HandName
1    Clubs    7 High Card
2 Diamonds    9 High Card
3 Diamonds    1 High Card
4   Spades   11 High Card
5   Spades    6 High Card

Player 4 Hand:
      Suit Rank  HandName
1    Clubs    6 High Card
2   Spades    5 High Card
3 Diamonds    2 High Card
4   Hearts    9 High Card
5    Clubs   10 High Card</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>t5<span class="ot">&lt;-</span><span class="fu">dealPokerRound</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Player 1 Hand:
      Suit Rank HandName
1    Clubs   13     Pair
2 Diamonds    9     Pair
3   Spades   10     Pair
4 Diamonds   10     Pair
5   Spades    8     Pair

Player 2 Hand:
    Suit Rank  HandName
1 Spades    5 High Card
2  Clubs    8 High Card
3 Hearts   10 High Card
4 Spades    1 High Card
5 Hearts    7 High Card

Player 3 Hand:
      Suit Rank  HandName
1   Spades    7 High Card
2 Diamonds    2 High Card
3   Hearts    3 High Card
4    Clubs   12 High Card
5    Clubs    6 High Card

Player 4 Hand:
      Suit Rank  HandName
1   Hearts    1 High Card
2    Clubs    4 High Card
3   Hearts    5 High Card
4 Diamonds   13 High Card
5 Diamonds    8 High Card

Player 5 Hand:
      Suit Rank  HandName
1    Clubs    5 High Card
2 Diamonds    7 High Card
3 Diamonds    1 High Card
4   Spades   11 High Card
5   Hearts   12 High Card

Player 6 Hand:
      Suit Rank HandName
1   Hearts    4     Pair
2   Hearts    2     Pair
3   Spades    4     Pair
4   Spades   13     Pair
5 Diamonds    3     Pair

Player 7 Hand:
      Suit Rank  HandName
1    Clubs    1 High Card
2   Spades    9 High Card
3 Diamonds    6 High Card
4    Clubs   10 High Card
5 Diamonds    4 High Card

Player 8 Hand:
      Suit Rank  HandName
1    Clubs    7 High Card
2   Spades   12 High Card
3    Clubs    9 High Card
4   Hearts   11 High Card
5 Diamonds    5 High Card

Player 9 Hand:
    Suit Rank HandName
1  Clubs   11     Pair
2 Spades    3     Pair
3 Spades    2     Pair
4 Hearts    6     Pair
5  Clubs    2     Pair

Player 10 Hand:
      Suit Rank  HandName
1 Diamonds   12 High Card
2 Diamonds   11 High Card
3   Spades    6 High Card
4   Hearts    8 High Card
5    Clubs    3 High Card</code></pre>
</div>
</div>
<p><strong>See if the code runs without modification in R. If so, demonstrate it with a range of inputs. If not, fix it and explain what you fixed. (If you identify that the code is massively broken, try re-generating the response.) At this point we only care if the code runs without errors for a variety on inputs; we’ll make sure it’s correct below.</strong></p>
<p>The code runs with only a small error that isStraight &lt;- diff(sort(unique(ranks))) == 1 there shows the warning:<em>I</em></p>
<p><em>n if (isStraight) { :</em></p>
<p><em>the condition has length &gt; 1 and only the first element will be used</em></p>
<p>and the hand like (1,2,3,6,8)was considered as straight falsely</p>
<p>I modified it as isStraight&lt;-all(diff(sort(unique(ranks)))== 1)</p>
<p><strong>Are the inputs and outputs as described above?</strong></p>
<p>Yes, for the first function,the name of hand is output after inputting the vector of suits and ranks. For the second function, the hand of cards are simulated after inputting number of players</p>
<p><strong>Are the hands valid (e.g.&nbsp;real cards, no duplicates, right number)?</strong></p>
<p>The hands are valid at least for the outputs of above 5 trials</p>
<p><strong>Are the names of the hands correct?</strong></p>
<p>The names of hands are correct except that Royal flush is not defined-</p>
<p><strong>Does it ensure no duplicates in cards across hands? What happens if you ask for more than 10 hands to be dealt (as there are only 52 cards in a standard deck)?</strong></p>
<p>Yes, it ensures no duplicate in cards across hands as the default setting for sample() is replace=FALSE</p>
<p>But if there are more than 10 hands, the suit and rank of extra cards will be displayed as NA, and the hand with all NA will be identified as Straight Flush</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dealPokerRound</span>(<span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Player 1 Hand:
      Suit Rank HandName
1 Diamonds    7     Pair
2    Clubs   12     Pair
3   Spades    9     Pair
4   Hearts    8     Pair
5   Spades   12     Pair

Player 2 Hand:
      Suit Rank HandName
1 Diamonds    5     Pair
2   Hearts   10     Pair
3 Diamonds   11     Pair
4   Hearts   13     Pair
5   Spades   13     Pair

Player 3 Hand:
      Suit Rank HandName
1 Diamonds    6     Pair
2    Clubs    8     Pair
3 Diamonds   13     Pair
4    Clubs   13     Pair
5    Clubs    5     Pair

Player 4 Hand:
      Suit Rank  HandName
1   Spades   10 High Card
2   Hearts    1 High Card
3 Diamonds    4 High Card
4    Clubs   11 High Card
5   Spades    8 High Card

Player 5 Hand:
      Suit Rank  HandName
1   Spades   11 High Card
2 Diamonds    3 High Card
3   Spades    7 High Card
4    Clubs    1 High Card
5 Diamonds   10 High Card

Player 6 Hand:
    Suit Rank  HandName
1  Clubs    4 High Card
2 Hearts    7 High Card
3  Clubs    2 High Card
4 Spades    5 High Card
5 Hearts   11 High Card

Player 7 Hand:
      Suit Rank  HandName
1    Clubs    7 High Card
2   Hearts    9 High Card
3   Spades    6 High Card
4 Diamonds   12 High Card
5   Hearts    3 High Card

Player 8 Hand:
    Suit Rank  HandName
1 Spades    4 High Card
2  Clubs   10 High Card
3 Spades    1 High Card
4 Hearts    6 High Card
5 Hearts    2 High Card

Player 9 Hand:
      Suit Rank HandName
1   Hearts    4     Pair
2 Diamonds    2     Pair
3    Clubs    3     Pair
4    Clubs    6     Pair
5   Spades    2     Pair

Player 10 Hand:
      Suit Rank HandName
1 Diamonds    9     Pair
2   Spades    3     Pair
3    Clubs    9     Pair
4 Diamonds    1     Pair
5   Hearts   12     Pair

Player 11 Hand:
      Suit Rank  HandName
1 Diamonds    8 High Card
2   Hearts    5 High Card
3     &lt;NA&gt;   NA High Card
4     &lt;NA&gt;   NA High Card
5     &lt;NA&gt;   NA High Card</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dealPokerRound</span>(<span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Player 1 Hand:
      Suit Rank HandName
1 Diamonds   12     Pair
2   Spades   10     Pair
3   Spades    6     Pair
4 Diamonds    8     Pair
5 Diamonds    6     Pair

Player 2 Hand:
      Suit Rank HandName
1   Hearts    8     Pair
2 Diamonds    1     Pair
3 Diamonds    5     Pair
4   Spades    1     Pair
5   Spades    7     Pair

Player 3 Hand:
    Suit Rank  HandName
1  Clubs   13 High Card
2 Spades    3 High Card
3  Clubs   11 High Card
4 Hearts    4 High Card
5  Clubs    8 High Card

Player 4 Hand:
    Suit Rank  HandName
1  Clubs    3 High Card
2 Spades   12 High Card
3 Hearts    1 High Card
4  Clubs    4 High Card
5  Clubs    5 High Card

Player 5 Hand:
      Suit Rank HandName
1    Clubs    7     Pair
2 Diamonds   11     Pair
3   Hearts   11     Pair
4   Hearts   13     Pair
5   Hearts    2     Pair

Player 6 Hand:
      Suit Rank  HandName
1   Hearts   10 High Card
2 Diamonds   13 High Card
3   Spades    2 High Card
4   Spades    4 High Card
5 Diamonds    9 High Card

Player 7 Hand:
      Suit Rank HandName
1 Diamonds    4     Pair
2    Clubs   12     Pair
3   Hearts   12     Pair
4    Clubs   10     Pair
5 Diamonds    7     Pair

Player 8 Hand:
      Suit Rank HandName
1 Diamonds    2     Pair
2    Clubs    2     Pair
3   Hearts    3     Pair
4   Spades    5     Pair
5 Diamonds   10     Pair

Player 9 Hand:
    Suit Rank  HandName
1  Clubs    1 High Card
2  Clubs    9 High Card
3 Spades   11 High Card
4 Hearts    7 High Card
5 Hearts    6 High Card

Player 10 Hand:
    Suit Rank HandName
1 Hearts    9     Pair
2 Spades    8     Pair
3 Spades   13     Pair
4 Spades    9     Pair
5  Clubs    6     Pair

Player 11 Hand:
      Suit Rank  HandName
1 Diamonds    3 High Card
2   Hearts    5 High Card
3     &lt;NA&gt;   NA High Card
4     &lt;NA&gt;   NA High Card
5     &lt;NA&gt;   NA High Card

Player 12 Hand:
  Suit Rank       HandName
1 &lt;NA&gt;   NA Straight Flush
2 &lt;NA&gt;   NA Straight Flush
3 &lt;NA&gt;   NA Straight Flush
4 &lt;NA&gt;   NA Straight Flush
5 &lt;NA&gt;   NA Straight Flush</code></pre>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>